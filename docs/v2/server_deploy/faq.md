# runtime/cgo: pthread_create failed: Operation not permitted

### 问题描述

```
start msg_transfer server
runtime/cgo: pthread_create failed: Operation not permitted
SIGABRT: abort
PC=0x7fb6241c6a7c m=0 sigcode=18446744073709551610

goroutine 0 [idle]:
runtime: unknown pc 0x7fb6241c6a7c
stack: frame={sp:0x7ffe40673940, fp:0x0} stack=[0x7ffe3fe74e98,0x7ffe40673ed0)
0x00007ffe40673840:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673850:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673860:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673870:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673880:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673890:  0x0000000000000000  0x0000000000000000 
0x00007ffe406738a0:  0x0000000000000000  0x0000000000000000 
0x00007ffe406738b0:  0x0000000000000000  0x0000000000000000 
0x00007ffe406738c0:  0x0000000000000000  0x0000000000000000 
0x00007ffe406738d0:  0x0000000000000000  0x0000000000000000 
0x00007ffe406738e0:  0x0000000000000000  0x0000000000000000 
0x00007ffe406738f0:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673900:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673910:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673920:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673930:  0x0000000000000000  0x00007fb6241c6a6e 
0x00007ffe40673940: <0x0000000000000000  0x0000000000000000 
0x00007ffe40673950:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673960:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673970:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673980:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673990:  0x0000000000000000  0x0000000000000000 
0x00007ffe406739a0:  0x0000000000000000  0x0000000000000000 
0x00007ffe406739b0:  0x0000000000000000  0x0000000000000000 
0x00007ffe406739c0:  0x0000000000000000  0x1fee610edfdc7500 
0x00007ffe406739d0:  0x00007fb62412eb80  0x0000000000000006 
0x00007ffe406739e0:  0x00000000020b02e0  0x0000000000000178 
0x00007ffe406739f0:  0x00000000014aa2c0  0x00007fb624172476 
0x00007ffe40673a00:  0x00007fb62434ae90  0x00007fb6241587f3 
0x00007ffe40673a10:  0x0000000000000020  0x0000000000000000 
0x00007ffe40673a20:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673a30:  0x0000000000000000  0x0000000000000000 
runtime: unknown pc 0x7fb6241c6a7c
stack: frame={sp:0x7ffe40673940, fp:0x0} stack=[0x7ffe3fe74e98,0x7ffe40673ed0)
0x00007ffe40673840:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673850:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673860:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673870:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673880:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673890:  0x0000000000000000  0x0000000000000000 
0x00007ffe406738a0:  0x0000000000000000  0x0000000000000000 
0x00007ffe406738b0:  0x0000000000000000  0x0000000000000000 
0x00007ffe406738c0:  0x0000000000000000  0x0000000000000000 
0x00007ffe406738d0:  0x0000000000000000  0x0000000000000000 
0x00007ffe406738e0:  0x0000000000000000  0x0000000000000000 
0x00007ffe406738f0:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673900:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673910:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673920:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673930:  0x0000000000000000  0x00007fb6241c6a6e 
0x00007ffe40673940: <0x0000000000000000  0x0000000000000000 
0x00007ffe40673950:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673960:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673970:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673980:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673990:  0x0000000000000000  0x0000000000000000 
0x00007ffe406739a0:  0x0000000000000000  0x0000000000000000 
0x00007ffe406739b0:  0x0000000000000000  0x0000000000000000 
0x00007ffe406739c0:  0x0000000000000000  0x1fee610edfdc7500 
0x00007ffe406739d0:  0x00007fb62412eb80  0x0000000000000006 
0x00007ffe406739e0:  0x00000000020b02e0  0x0000000000000178 
0x00007ffe406739f0:  0x00000000014aa2c0  0x00007fb624172476 
0x00007ffe40673a00:  0x00007fb62434ae90  0x00007fb6241587f3 
0x00007ffe40673a10:  0x0000000000000020  0x0000000000000000 
0x00007ffe40673a20:  0x0000000000000000  0x0000000000000000 
0x00007ffe40673a30:  0x0000000000000000  0x0000000000000000 

goroutine 1 [running]:
runtime.systemstack_switch()
	/usr/local/go/src/runtime/asm_amd64.s:436 fp=0xc000052780 sp=0xc000052778 pc=0x46ea20
runtime.main()
	/usr/local/go/src/runtime/proc.go:170 +0x6d fp=0xc0000527e0 sp=0xc000052780 pc=0x440c8d
runtime.goexit()
	/usr/local/go/src/runtime/asm_amd64.s:1571 +0x1 fp=0xc0000527e8 sp=0xc0000527e0 pc=0x470c41
```

### 解决途径

使用docker版本为20.10.14, docker-compose版本为1.24.1

# platform is not same to token platform

在登录时返回这个错误，表示获取token的platformID和初始化时的platformID不一致

 Open_IM/pkg/common/token_verify.WsVerifyToken()@279:  platform is not same to token platform args: token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVSUQiOiIzMDY0ODMzNTgzIiwiUGxhdGZvcm0iOiJBbmRyb2lkIiwiZXhwIjoxOTcyOTA0MDk5LCJuYmYiOjE2NTc1NDQwOTksImlhdCI6MTY1NzU0NDA5OX0.W0vISNx9pmJD6UMwGDEW1gigU8QywUxpjexfuSSq0Mk
 operationID: 1657544102328748318 userID: 3064833583 platformID: IOS claims platformID: Android: different platformID operationID 1657544102328748318websocket: bad handshake 707

比如这个表示用Platform为2（Android）获取token，但初始化Platform为1（IOS ）

# uid is not same to token uid

在登录时返回这个错误，表示获取token的userID和登录时的userID不一致

Open_IM/pkg/common/token_verify.WsVerifyToken()@275:  uid is not same to token uid
 args: token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVSUQiOiIxMTg3MzM2ODUzIiwiUGxhdGZvcm0iOiJJT1MiLCJleHAiOjE5NzI5MDU1MDksIm5iZiI6MTY1NzU0NTUwOSwiaWF0IjoxNjU3NTQ1NTA5fQ.K3BhR8RNwgKR2kgivcBkjByn79Xi4rinIzB5oYyLbCQ operationID: 
1657545511742178518 userID: 3064833583 platformID: IOS claims.UID: 1187336853: different userID operationID 1657545511742178518websocket: bad handshake 708

比如这个表示用1187336853获取token，但登录的userID为3064833583 

